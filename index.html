<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>じゃんけんAI</title>
    <style>
        .buttons {
            margin: 20px;
        }
        button {
            font-size: 20px;
            padding: 10px 20px;
        }
        #predictedHand {
            font-size: 20px;
            margin: 20px 0;
            display: none;
        }
        #result, #totalRecord {
            font-size: 20px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>じゃんけんAI</h1>
    <div class="buttons">
        <button onclick="play(0)">グー</button>
        <button onclick="play(1)">チョキ</button>
        <button onclick="play(2)">パー</button>
    </div>
    <button onclick="showPredictedHand()">予測されている手を見る</button>
    <div id="predictedHand">予測されている手: </div>
    <div id="result">結果: </div>
    <div id="totalRecord">&#8203;``【oaicite:1】``&#8203;勝ち: 0 - 引き分け: 0 - 負け: 0 - 勝率: 0%</div>

    <script>
        let record = [0, 0, 0, 0, 0];
        let win = 0, draw = 0, lose = 0;

        function setRecord(hand) {
            record.unshift(hand);
            record.pop();
        }

        function calcSumHand() {
            const sumRecordHand = [0, 0, 0];
            for (let hand of record) {
                sumRecordHand[hand]++;
            }
            const maxHand = sumRecordHand.indexOf(Math.max(...sumRecordHand));
            return (maxHand + 1) % 3;
        }

        function play(playerHand) {
            const predictedHand = calcSumHand();
            setRecord(playerHand);

            document.getElementById('predictedHand').innerText = '予測されている手: ' + handToStr(predictedHand);
            document.getElementById('predictedHand').style.display = 'block';

            let result;
            if (playerHand === predictedHand) {
                draw++;
                result = '引き分け';
            } else if ((playerHand - predictedHand + 3) % 3 === 1) {
                lose++;
                result = '負け';
            } else {
                win++;
                result = '勝ち';
            }
            document.getElementById('result').innerText = '結果: ' + result;

            const totalGames = win + draw + lose;
            const winRate = totalGames > 0 ? (win / totalGames * 100).toFixed(2) : 0;
            document.getElementById('totalRecord').innerText = `&#8203;``【oaicite:0】``&#8203;勝ち: ${win} - 引き分け: ${draw} - 負け: ${lose} - 勝率: ${winRate}%`;
        }

        function showPredictedHand() {
            const predictedHand = calcSumHand();
            alert('予測されている手: ' + handToStr(predictedHand));
        }

        function handToStr(hand) {
            return ['グー', 'チョキ', 'パー'][hand];
        }
    </script>
</body>
</html>
